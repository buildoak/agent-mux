# How to Update agent-mux

Instructions for AI agents performing skill updates.

## Quick Update (for agents)

1. Fetch latest: `git clone https://github.com/buildoak/agent-mux.git /tmp/agent-mux-latest`
2. Read `UPDATES.md` in this skill's directory to see what changed
3. For each entry in `new-files`: copy to user's local installation (safe, no conflicts)
4. For each entry in `changed-files`:
   - If user has NO local edits: overwrite with new version
   - If user HAS local edits: show diff, let user decide
5. For each entry in `removed-files`: delete the old file after confirming the replacement exists
6. Check `breaking-changes` -- if any, require explicit user confirmation
7. Check `migration-notes` -- apply structural changes (new directories, moved files)
8. Run `./setup.sh` to ensure dependencies are current

## What NOT to do
- Never delete the user's entire skill folder and re-copy
- Never overwrite files the user customized without asking
- Never auto-apply breaking changes
- Never modify files outside the skill directory

## Skill-specific notes

### mcp-clusters.yaml is user-specific
The MCP cluster config at `./mcp-clusters.yaml` and `~/.config/agent-mux/mcp-clusters.yaml` is user-customized. Never overwrite it. If the example config (`mcp-clusters.example.yaml`) has new entries, mention them to the user but do not modify their config.

### node_modules/ should not be copied
The `node_modules/` directory is generated by `bun install`. Never copy it between machines. Run `./setup.sh` or `bun install` after updating to regenerate.

### API keys are separate from skill files
API keys (`OPENAI_API_KEY`, `ANTHROPIC_API_KEY`, `OPENROUTER_API_KEY`) live in the user's environment, not in the repo. Updating the skill does not affect API keys.

### setup.sh should be re-run after updates
After copying new files, run `./setup.sh` to ensure dependencies are current and TypeScript compiles cleanly. The script is idempotent.

### Claude Code vs standalone installs
- Claude Code installs live at `<project>/.claude/skills/agent-mux/`
- Standalone installs can be anywhere
- The update process is the same for both -- copy changed files, run `setup.sh`
